<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Harga TikTok</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            padding: 20px;
            background: #fff;
        }
        .header {
            text-align: center;
            padding-top: 20px;
        }
        h1, h2 {
            text-align: center;
            color: #1a1a1a;
        }
        .input-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
        }
        .input-group label {
            flex-basis: 70%; /* Label takes more width */
            margin-right: 10px;
            font-weight: normal;
        }
        .input-group input[type="number"] {
            flex-basis: 25%; /* Input takes less width */
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            text-align: right; /* Align text to the right for numbers */
        }
        .results {
            position: sticky;
            top: 0;
            z-index: 1000;
            background-color: #e9ecef;
            padding: 10px 20px;
            border-bottom: 1px solid #ddd;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .results-info {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        .price-display {
            font-size: 2em;
            font-weight: bold;
            color: #28a745;
        }
        .price-display-label {
            display: block;
            font-size: 0.7em;
            color: #555;
            font-weight: normal;
        }
        .single-line-results {
            margin: 10px 0;
            display: flex;
            justify-content: center; /* Center items for better mobile display */
            align-items: center;
            flex-wrap: wrap;
            gap: 15px; /* Add some space between items */
        }
        .single-line-results p {
            margin: 0; /* Remove default paragraph margin */
            font-size: 1em;
            white-space: nowrap; /* Prevent wrapping for compact display */
        }
        .profit-info.negative {
            color: #dc3545;
            font-weight: bold;
        }
        .warning {
            color: #ffc107;
            font-weight: bold;
        }
        .content {
            padding: 20px;
        }
        .footer {
            text-align: center;
            padding: 20px;
            color: #777;
            font-size: 0.9em;
        }
        /* New style for single-line profit display */
        .profit-kompetitor-display {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2em;
            font-weight: bold;
        }
        .profit-kompetitor-display .label {
            font-weight: normal;
            margin-right: 5px;
        }

        /* Responsive adjustments for smaller screens */
        @media (max-width: 600px) {
            .input-group label, .input-group input[type="number"] {
                flex-basis: 100%; /* Stack label and input on very small screens */
                margin-right: 0;
            }
            .input-group input[type="number"] {
                margin-top: 5px; /* Add some space between stacked label and input */
                text-align: left; /* Align left when stacked */
            }
            .single-line-results {
                flex-direction: column; /* Stack results vertically on small screens */
                align-items: center;
                gap: 5px;
            }
            .results .price-display {
                font-size: 1.8em; /* Slightly smaller font for sticky header on mobile */
            }
            .results-info {
                margin-bottom: 5px;
            }
        }
    </style>
</head>
<body>

<div class="results">
    <div class="results-info">
        <div>
            <span class="price-display-label">Harga Jual:</span>
            <span class="price-display" id="hargaJualDisplay">Rp 0</span>
        </div>
    </div>
    <div class="single-line-results">
        <p>Markup HPP: <span id="minimalMarkup">0%</span></p>
        <p>Profit: <span id="targetProfitInfo">Rp 0 (0%)</span></p>
    </div>
</div>

<div class="container">
    <div class="header">
        <h1>Kalkulator TikTok</h1>
    </div>

    <div class="content">
        <div class="input-group">
            <label for="hpp">Harga Pokok / HPP (Rp)</label>
            <input type="number" id="hpp" value="40000" onfocus="this.select()">
        </div>

        <div class="input-group">
            <label for="profit">Target Profit (%)</label>
            <input type="number" id="profit" value="10" onfocus="this.select()">
        </div>
        
        <div class="input-group">
            <label for="operational">Biaya Operasional (%)</label>
            <input type="number" id="operational" value="2" onfocus="this.select()">
        </div>
        
        <div class="input-group">
            <label for="admin">Biaya Admin (%)</label>
            <input type="number" id="admin" value="17" onfocus="this.select()">
        </div>

        <div class="input-group">
            <label for="flat">Biaya Flat (Rp)</label>
            <input type="number" id="flat" value="1250" onfocus="this.select()">
        </div>

        <div class="input-group">
            <label for="affiliate">Komisi Affiliate (%)</label>
            <input type="number" id="affiliate" value="10" onfocus="this.select()">
        </div>

        <div class="input-group">
            <label for="ads">Iklan (%)</label>
            <input type="number" id="ads" value="10" onfocus="this.select()">
        </div>

        <hr>

        <h2>Cek Harga Kompetitor</h2>
        <div class="input-group">
            <label for="customHarga">Harga Jual (Rp)</label>
            <input type="number" id="customHarga" placeholder="Masukkan harga jual..." onfocus="this.select()">
        </div>

        <div class="results-static">
            <h2></h2>
            <p class="profit-kompetitor-display profit-info">
                <span class="label">Profit:</span>
                <span id="profitKompetitorInfo">Rp 0 (0%)</span>
            </p>
        </div>
    </div>
</div>

<div class="footer">
    Created by Endro Kaukah 2025
</div>

<script>
    const hppInput = document.getElementById('hpp');
    const profitInput = document.getElementById('profit');
    const operationalInput = document.getElementById('operational');
    const adminInput = document.getElementById('admin');
    const flatInput = document.getElementById('flat');
    const affiliateInput = document.getElementById('affiliate');
    const adsInput = document.getElementById('ads');
    const hargaJualDisplay = document.getElementById('hargaJualDisplay');
    /* const pembulatanHargaJualDisplay = document.getElementById('pembulatanHargaJual'); */ // Removed
    const minimalMarkupDisplay = document.getElementById('minimalMarkup');
    const targetProfitInfoDisplay = document.getElementById('targetProfitInfo');
    const customHargaInput = document.getElementById('customHarga');
    const profitKompetitorInfoDisplay = document.getElementById('profitKompetitorInfo');

    function formatRupiah(number) {
        if (isNaN(number) || number === null) {
            return '⚠️ Belum Lengkap';
        }
        const formattedNumber = parseInt(Math.round(number));
        return 'Rp ' + formattedNumber.toLocaleString('id-ID');
    }

    function calculateSellingPrice() {
        const hpp = parseFloat(hppInput.value);
        const targetProfitPercentage = parseFloat(profitInput.value) / 100;
        const operationalPercentage = parseFloat(operationalInput.value) / 100;
        const adminPercentage = parseFloat(adminInput.value) / 100;
        const flat = parseFloat(flatInput.value);
        const affiliatePercentage = parseFloat(affiliateInput.value) / 100;
        const adsPercentage = parseFloat(adsInput.value) / 100;

        const totalCostPercentage = operationalPercentage + adminPercentage + affiliatePercentage + adsPercentage + targetProfitPercentage;
        
        if (isNaN(hpp) || isNaN(flat) || isNaN(totalCostPercentage)) {
            const warningText = '⚠️ Belum Lengkap';
            hargaJualDisplay.textContent = warningText;
            /* pembulatanHargaJualDisplay.textContent = warningText; */ // Removed
            minimalMarkupDisplay.textContent = warningText;
            targetProfitInfoDisplay.textContent = warningText;
            return;
        }

        const denominator = 1 - totalCostPercentage;
        if (denominator <= 0) {
            const warningText = '⚠️ Total biaya >= 100%';
            hargaJualDisplay.textContent = warningText;
            /* pembulatanHargaJualDisplay.textContent = warningText; */ // Removed
            minimalMarkupDisplay.textContent = warningText;
            targetProfitInfoDisplay.textContent = warningText;
            return;
        }

        const hargaJual = (hpp + flat) / denominator;
        const pembulatan = Math.ceil(hargaJual / 1000) * 1000;
        const minimalMarkup = ((hargaJual / hpp) - 1) * 100;
        const calculatedTargetProfitRp = hargaJual * targetProfitPercentage;

        hargaJualDisplay.textContent = formatRupiah(hargaJual);
        /* pembulatanHargaJualDisplay.textContent = formatRupiah(pembulatan); */ // Removed
        minimalMarkupDisplay.textContent = `${Math.round(minimalMarkup)}%`;
        targetProfitInfoDisplay.textContent = `${formatRupiah(calculatedTargetProfitRp)} (${Math.round(targetProfitPercentage * 100)}%)`;

        // Memastikan harga kompetitor otomatis terisi hanya jika belum ada input manual
        if (document.activeElement !== customHargaInput) {
            customHargaInput.value = pembulatan;
        }

        checkCustomPrice();
    }

    function checkCustomPrice() {
        const hpp = parseFloat(hppInput.value);
        const customHarga = parseFloat(customHargaInput.value);
        const operationalPercentage = parseFloat(operationalInput.value) / 100;
        const adminPercentage = parseFloat(adminInput.value) / 100;
        const flat = parseFloat(flatInput.value);
        const affiliatePercentage = parseFloat(affiliateInput.value) / 100;
        const adsPercentage = parseFloat(adsInput.value) / 100;

        if (isNaN(customHarga) || isNaN(hpp) || isNaN(operationalPercentage) || isNaN(adminPercentage) || isNaN(flat) || isNaN(affiliatePercentage) || isNaN(adsPercentage)) {
            profitKompetitorInfoDisplay.textContent = '⚠️ Belum Lengkap';
            return;
        }

        const operationalCost = customHarga * operationalPercentage;
        const adminCost = customHarga * adminPercentage;
        const affiliateCost = customHarga * affiliatePercentage;
        const adsCost = customHarga * adsPercentage;

        const profitRp = customHarga - hpp - operationalCost - adminCost - flat - affiliateCost - adsCost;
        const profitPersen = (profitRp / customHarga) * 100;

        profitKompetitorInfoDisplay.textContent = `${formatRupiah(profitRp)} (${Math.round(profitPersen)}%)`;

        const profitKompetitorContainer = profitKompetitorInfoDisplay.parentElement;
        if (profitRp < 0) {
            profitKompetitorContainer.classList.add('negative');
        } else {
            profitKompetitorContainer.classList.remove('negative');
        }
    }

    const inputs = document.querySelectorAll('#hpp, #profit, #operational, #admin, #flat, #affiliate, #ads');
    inputs.forEach(input => {
        input.addEventListener('input', () => {
            calculateSellingPrice();
        });
    });

    customHargaInput.addEventListener('input', checkCustomPrice);

    document.addEventListener('DOMContentLoaded', () => {
        calculateSellingPrice();
    });
</script>

</body>
</html>
